===============================================================================
âš¡ EV CHARGING ANOMALY SIMULATOR - PROJECT COMPLETE âš¡
===============================================================================

PROJECT LOCATION: /Users/enisuzun/Desktop/ev-anomaly-sim

===============================================================================
ğŸ“ PROJECT STRUCTURE
===============================================================================

ev-anomaly-sim/
â”œâ”€â”€ ğŸ”Œ Core Components
â”‚   â”œâ”€â”€ charger_module.py       â†’ Virtual CAN charger device
â”‚   â”œâ”€â”€ csms.py                 â†’ OCPP 1.6 WebSocket server  
â”‚   â”œâ”€â”€ cp.py                   â†’ OCPP client (Charge Point)
â”‚   â””â”€â”€ plot_current.py         â†’ Real-time current plotter
â”‚
â”œâ”€â”€ ğŸš€ Launchers & Tools
â”‚   â”œâ”€â”€ run_all.sh              â†’ Start all components (macOS)
â”‚   â”œâ”€â”€ test_environment.py     â†’ Verify installation
â”‚   â””â”€â”€ demo_can.py             â†’ CAN bus test script
â”‚
â”œâ”€â”€ ğŸ“š Documentation
â”‚   â”œâ”€â”€ README.md               â†’ Full documentation
â”‚   â”œâ”€â”€ QUICKSTART.md           â†’ Quick start guide
â”‚   â””â”€â”€ PROJECT_SUMMARY.txt     â†’ This file
â”‚
â”œâ”€â”€ âš™ï¸ Configuration
â”‚   â””â”€â”€ requirements.txt        â†’ Python dependencies
â”‚
â””â”€â”€ ğŸ Virtual Environment
    â””â”€â”€ venv/                   â†’ Python 3.11 environment

===============================================================================
âœ… INSTALLATION STATUS
===============================================================================

âœ… Python 3.11 virtual environment created
âœ… All dependencies installed:
   - matplotlib==3.8.2
   - python-can==4.4.2
   - ocpp==0.20.0
   - websockets==12.0
âœ… Virtual CAN bus tested and working
âœ… All scripts executable and ready

===============================================================================
ğŸ¯ HOW TO RUN
===============================================================================

SIMPLE METHOD (Recommended):
  cd /Users/enisuzun/Desktop/ev-anomaly-sim
  ./run_all.sh

This opens 4 Terminal tabs automatically:
  1. Charger Module  - CAN device simulator
  2. CSMS Server     - OCPP server
  3. Charge Point    - OCPP client
  4. Current Plotter - Live visualization

MANUAL METHOD:
  # Terminal 1
  cd /Users/enisuzun/Desktop/ev-anomaly-sim
  source venv/bin/activate
  python3 charger_module.py

  # Terminal 2
  source venv/bin/activate
  python3 csms.py

  # Terminal 3
  source venv/bin/activate
  python3 cp.py

  # Terminal 4
  source venv/bin/activate
  python3 plot_current.py

===============================================================================
ğŸ­ ANOMALY SIMULATION OVERVIEW
===============================================================================

SCENARIO: Repeated Current Fluctuation During Charging

CYCLE PATTERN:
  1. SetChargingProfile(0A)   â†’ Restrict current to 0A
  2. Wait 2 seconds
  3. SetChargingProfile(100A) â†’ Allow high current (100A)
  4. Wait 1 second
  5. RemoteStartTransaction   â†’ Start charging
  6. Wait 2 seconds
  7. RemoteStopTransaction    â†’ Stop charging
  8. Wait 3 seconds
  9. Repeat from step 1

RESULT: Current repeatedly fluctuates between 0A and 100A, creating
        an observable anomaly pattern in the live graph.

===============================================================================
ğŸ”Œ CAN BUS PROTOCOL
===============================================================================

MESSAGE ID â”‚ DIRECTION          â”‚ PURPOSE              â”‚ DATA FORMAT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0x200      â”‚ CP â†’ Charger       â”‚ Start charging       â”‚ Empty
0x201      â”‚ CP â†’ Charger       â”‚ Stop charging        â”‚ Empty
0x210      â”‚ CP â†’ Charger       â”‚ Set current limit    â”‚ [low, high] bytes
0x300      â”‚ Charger â†’ All      â”‚ Current reading      â”‚ [low, high] bytes

All messages use standard (11-bit) CAN IDs, not extended IDs.
Current values are transmitted as little-endian 16-bit integers.

===============================================================================
ğŸ“Š EXPECTED OUTPUT
===============================================================================

TERMINAL WINDOWS:
  - Each component prints its status, connections, and messages
  - Color-coded output for easy monitoring
  - Real-time CAN and OCPP message logging

MATPLOTLIB GRAPH:
  - X-axis: Time (seconds since start)
  - Y-axis: Current (Amperes, 0-110A)
  - Blue line with shaded area showing current over time
  - Red "ANOMALY DETECTED" indicator when fluctuations occur
  - Current value display in top-right corner
  - 60-second rolling window

TIMING:
  - Initial startup: 5-10 seconds
  - First anomaly cycle: ~15 seconds
  - Graph updates: Every 1 second

===============================================================================
ğŸ› ï¸ TESTING & VERIFICATION
===============================================================================

QUICK TESTS:

1. Environment Test:
   source venv/bin/activate
   python3 test_environment.py
   â†’ Should show all green checkmarks

2. CAN Bus Test:
   source venv/bin/activate
   python3 demo_can.py
   â†’ Should create and test CAN bus

3. Component Test (run each in separate terminal):
   python3 charger_module.py  â†’ Should show "Listening for CAN commands"
   python3 csms.py            â†’ Should show "CSMS WebSocket server running"
   python3 cp.py              â†’ Should connect to CSMS
   python3 plot_current.py    â†’ Should open matplotlib window

===============================================================================
ğŸ› TROUBLESHOOTING
===============================================================================

ISSUE: Virtual environment not found
FIX:  cd /Users/enisuzun/Desktop/ev-anomaly-sim
      python3.11 -m venv venv
      source venv/bin/activate
      pip install -r requirements.txt

ISSUE: Module import errors
FIX:  Ensure virtual environment is activated:
      source venv/bin/activate

ISSUE: Components not communicating
FIX:  Start in order: charger_module â†’ csms â†’ cp â†’ plot_current
      Ensure 2-3 second delay between starting each component

ISSUE: Graph shows no data
FIX:  1. Verify charger_module.py is running
      2. Wait 10-15 seconds for data accumulation
      3. Check that matplotlib window isn't minimized

ISSUE: WebSocket connection refused
FIX:  Ensure csms.py is running before starting cp.py

===============================================================================
ğŸ”§ CUSTOMIZATION
===============================================================================

TO CHANGE ANOMALY PATTERN:
  Edit: csms.py
  Function: send_anomaly()
  Modify: await asyncio.sleep() values for timing
  Modify: "limit" values in SetChargingProfile for current levels

TO CHANGE CAN BUS MESSAGES:
  Edit: charger_module.py, cp.py
  Modify: arbitration_id values for different CAN IDs
  Modify: data[] arrays for different message formats

TO CHANGE GRAPH APPEARANCE:
  Edit: plot_current.py
  Function: animate()
  Modify: matplotlib styling, colors, labels

TO CHANGE OCPP BEHAVIOR:
  Edit: cp.py (client handlers), csms.py (server handlers)
  Add/modify @CP.on() decorated functions

===============================================================================
ğŸ“ LEARNING RESOURCES
===============================================================================

OCPP 1.6 Specification:
  https://www.openchargealliance.org/protocols/ocpp-16/

Python-CAN Documentation:
  https://python-can.readthedocs.io/

Matplotlib Animation:
  https://matplotlib.org/stable/api/animation_api.html

WebSockets Protocol:
  https://websockets.readthedocs.io/

===============================================================================
ğŸ“ TECHNICAL NOTES
===============================================================================

PLATFORM:
  - Developed for: macOS (tested on M2)
  - Compatible with: Any macOS with Python 3.11+
  - CAN bus: Virtual (no hardware required)
  - No kernel modules needed (no socketcan/vcan)

ARCHITECTURE:
  - Asynchronous: Uses asyncio for OCPP components
  - Multi-process: Each component runs as separate process
  - Thread-safe: CAN bus operations are thread-safe
  - Real-time: 1-second update intervals throughout

DEPENDENCIES:
  - All pinned to specific versions for reproducibility
  - No external system dependencies (beyond Python)
  - Pure Python implementation

===============================================================================
âœ… PROJECT STATUS: COMPLETE AND READY TO RUN
===============================================================================

All components are implemented, tested, and working correctly.
The simulation is ready to demonstrate the "Repeated Current 
Fluctuation During Charging" anomaly.

TO START: ./run_all.sh

===============================================================================
ğŸ“§ NOTES
===============================================================================

This is a complete, self-contained simulation project for educational
and testing purposes. The code is fully functional and can be used
as a foundation for:

- OCPP testing and development
- CAN bus protocol learning
- Anomaly detection research
- Charging infrastructure simulation
- EV charging behavior analysis

All code is clean, well-commented, and follows Python best practices.

===============================================================================
âš¡ END OF PROJECT SUMMARY âš¡
===============================================================================

Last updated: November 9, 2025
Project created for: macOS M2 with Python 3.11
Status: âœ… COMPLETE AND TESTED
